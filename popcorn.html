<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.16/angular.min.js"></script>
</head>
<body ng-app ="myApp">
    <h2> Welcome to Millenium Gynmastics Booster Club Popcorn Sales </h2>

    <div ng-controller="myController">
      <form name="orderForm" >
      <table>
        <tr>
          <td> Buyer's Name: </td>
          <td> <input type = "text"  name = "name"
                      size = "30" />
          </td>
        </tr>
        <tr>
          <td> Street Address: </td>
          <td> <input type = "text"  name = "street"
                      size = "30" />
          </td>
        </tr>
        <tr>
          <td> Zip code: </td>
          <!-- Call JS function getPlace() when zip code box is changed -->
          <td> <input type = "text"  name = "zip" ng-model="zip"
                      size = "10" ng-blur="getPlace()" />
                     
          </td>
        </tr>
        <tr>
          <td> City </td>
          <td> <input type = "text"  name = "city"
                      id = "city"  size = "30" value={{data}} />
          </td>
        </tr>
        <tr>
          <td> State </td>
          <td> <input type = "text"  name = "state"
                      id = "state"  size = "30" />
          </td>
        </tr>
      </table>


      <p>
        <input type = "submit"  value = "Submit Order" />
        <input type = "reset"  value = "Clear Order Form" />
      </p>
      </form>
      
      Entry: {{zip}} <br/>
      Response Data: {{data}} <br />
      Error: {{error}}
   </div>

   <script>
      var myApp = angular.module('myApp', []);

      myApp.controller("myController", function ($scope, $http)
      {
         var onSuccess = function (data, status, headers, config)
         {
            $scope.data = data;
         };

         var onError = function (data, status, headers, config)
         {
            $scope.error = status;
         }
         
         var zip = $scope.zip;
         $scope.getPlace = function() {
            if ($scope.zip !== undefined){
               var promise = $http.post("http://localhost/bullet-journal/testing.php", {"zip": $scope.zip});
//               var promise = $http.get("http://localhost/angularDemo/popcorn/getCityState.php?zip=" + $scope.zip);
               promise.success(onSuccess);
               promise.error(onError); 
            }  
            else
            {
        	   $scope.data = "undefined"; 
            }
         }

      });
    </script>
</body>
</html>